---
# Aquarium Reset to Zero Script
# Resets all light channels to zero state by sending repeated down commands
# This ensures the physical light state matches the helper values

alias: "Aquarium Reset to Zero"
description: "Sends repeated 'down' commands to ensure all channels are at 0"
icon: "mdi:restore"
mode: single

sequence:
  # Send individual down commands for each channel to prevent interference
  # Using 12 repetitions to guarantee zero state even if starting at max (10)
  - repeat:
      count: 12
      sequence:
        # Send white channel down command
        - service: remote.send_command
          target:
            entity_id: remote.rm4_pro_remote  # UPDATE: Change to your actual Broadlink entity ID
          data:
            device: hygger_hg016
            command: white_down
        - delay:
            milliseconds: 500
        
        # Send red channel down command
        - service: remote.send_command
          target:
            entity_id: remote.rm4_pro_remote  # UPDATE: Change to your actual Broadlink entity ID
          data:
            device: hygger_hg016
            command: red_down
        - delay:
            milliseconds: 500
        
        # Send green channel down command
        - service: remote.send_command
          target:
            entity_id: remote.rm4_pro_remote  # UPDATE: Change to your actual Broadlink entity ID
          data:
            device: hygger_hg016
            command: green_down
        - delay:
            milliseconds: 500
        
        # Send blue channel down command
        - service: remote.send_command
          target:
            entity_id: remote.rm4_pro_remote  # UPDATE: Change to your actual Broadlink entity ID
          data:
            device: hygger_hg016
            command: blue_down
        - delay:
            milliseconds: 500

  # Update all helper entities to reflect zero state
  - service: input_number.set_value
    target:
      entity_id:
        - input_number.hygger_white_level
        - input_number.hygger_red_level
        - input_number.hygger_green_level
        - input_number.hygger_blue_level
    data:
      value: 0

  # Optional: Log the reset action for debugging
  - service: system_log.write
    data:
      message: "Aquarium lights reset to zero - all channels at 0"
      level: info